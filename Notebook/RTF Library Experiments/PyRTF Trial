"""
Note: Python libraries for handling Rich Text files
are neither well maintained nor well documented.
The only library that works well with Python 3+ is 
pyrtf 0.45:

https://anaconda.org/conda-forge/pyrtf
conda install conda-forge::pyrtf
"""

from tkinter import *
from tkinter import filedialog
from pythondocx import RTFReader, RTFWriter
from docx import Document
from reportlab.pdfgen import canvas

def open_file():
    file_path = filedialog.askopenfilename(filetypes=[("Text files", "*.txt"), ("Word files", "*.docx"), ("Rich Text Format files", "*.rtf")])
    if file_path:
        if file_path.endswith((".txt", ".docx")):
            with open(file_path, 'r', encoding='utf-8') as file:
                content = file.read()
        elif file_path.endswith(".rtf"):
            doc = RTFReader.read(file_path)
            content = "\n".join([paragraph.text for paragraph in doc.paragraphs])
        text.delete(1.0, END)
        text.insert(END, content)

def save_file():
    file_path = filedialog.asksaveasfilename(defaultextension=".txt", filetypes=[("Text files", "*.txt"), ("Word files", "*.docx"), ("Rich Text Format files", "*.rtf"), ("PDF files", "*.pdf")])
    if file_path:
        content = text.get(1.0, END)
        if file_path.endswith((".txt", ".docx")):
            with open(file_path, 'w', encoding='utf-8') as file:
                file.write(content)
        elif file_path.endswith(".rtf"):
            doc = RTFReader.read(content)
            with open(file_path, 'w', encoding='utf-8') as file:
                file.write(RTFWriter.write(doc).getvalue())
        elif file_path.endswith(".pdf"):
            pdf_canvas = canvas.Canvas(file_path)
            pdf_canvas.drawString(100, 800, content)
            pdf_canvas.save()


# Rest of the code remains the same
# Create the main window
root = Tk()
root.title("Text Editor")

# Create a Text widget
text = Text(root, wrap="word")
text.pack(expand=YES, fill=BOTH)

# Create a Menu
menubar = Menu(root)
root.config(menu=menubar)

# File menu
file_menu = Menu(menubar, tearoff=0)
menubar.add_cascade(label="File", menu=file_menu)

# File menu items
file_menu.add_command(label="Open", command=open_file)
file_menu.add_command(label="Save", command=save_file)
file_menu.add_separator()
file_menu.add_command(label="Exit", command=root.destroy)

# Start the main event loop
root.mainloop()

