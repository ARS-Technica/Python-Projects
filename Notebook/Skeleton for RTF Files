"""
The following is a test bed for adding the ability
to save file in a rich text format using Python.
Hopefully, this code will eventually be merged into
the Notebook Text Editor I'm creating with Tkinter.

Note: Python libraries for handling Rich Text files
are neither well maintained nor well documented.
"""

from pyth.plugins.plaintext.writer import PlaintextWriter
from pyth.plugins.rtf15.reader import Rtf15Reader
from pyth import Document

def read_rtf(file_path):
    with open(file_path, 'rb') as f:
        try:
            # Try reading the RTF content
            doc = Rtf15Reader.read(f)
            plain_text = PlaintextWriter.write(doc).getvalue()
            return plain_text
        except UnicodeDecodeError:
            # If a UnicodeDecodeError occurs, assume it's a Python 3 issue
            f.seek(0)
            content = f.read().decode('latin-1')  # Convert from ISO-8859-1 to Unicode
            doc = Rtf15Reader.read(content)
            plain_text = PlaintextWriter.write(doc).getvalue()
            return plain_text

# Example usage
file_path = 'example.rtf'
content = read_rtf(file_path)
print(content)

