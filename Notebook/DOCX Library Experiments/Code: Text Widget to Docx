"""
The following is an attempt to convert the .configure method
used in Tkinter's text widget to tags that format text inside
a .docx file using the Python Docx library.
"""

def save_to_docx():
    file_path = filedialog.asksaveasfilename(defaultextension=".docx")
    if file_path:
        document = Document()
        start_index = "1.0"
        end_index = "1.0"
        while True:
            end_index = text_widget.search(r"\S", end_index, stopindex="end", regexp=True)
            if not end_index:
                break
            end_index = text_widget.search(r"\s", end_index, stopindex="end", regexp=True)
            if not end_index:
                end_index = "end"
            tags = text_widget.tag_names(start_index)
            word = text_widget.get(start_index, end_index)
            format_word(document, word, tags)
            start_index = end_index

        document.save(file_path)

def format_word(document, word, tags):
    p = document.add_paragraph()
    run = p.add_run(word)
    for tag in tags:
        if tag == "bold":
            run.bold = True
        elif tag == "italic":
            run.italic = True
        elif tag == "underline":
            run.underline = True
        elif tag == "font_size":
            font_size = int(text_widget.tag_cget("font_size", "font")[6:])
            run.font.size = Pt(font_size)
    run.add_text(" ")


# Puts each word of its own line
