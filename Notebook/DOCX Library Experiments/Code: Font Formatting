"""
Now that I have a function that converts text files created in a tkinter 
interface into clean .Docx files, I need to incorporate font faces and 
font sizes into the interface without interfering with the conversion function. 
"""


import tkinter as tk
from tkinter import font
from tkinter import messagebox
from tkinter import ttk
import uuid


def apply_font_face(event=None):
    if text_widget.tag_ranges("sel"):
        # Generate a unique tag for the selected text
        tag_name = "font_face_" + str(uuid.uuid4())
        text_widget.tag_add(tag_name, "sel.first", "sel.last")
        # Apply the font face configuration to the unique tag
        text_widget.tag_configure(tag_name, font=(font_family_var.get(), text_widget.tag_cget("sel.first", "font")[1]))

def apply_font_size(event=None):
    if text_widget.tag_ranges("sel"):
        # Generate a unique tag for the selected text
        tag_name = "font_size_" + str(uuid.uuid4())
        text_widget.tag_add(tag_name, "sel.first", "sel.last")
        # Apply the font size configuration to the unique tag
        text_widget.tag_configure(tag_name, font=(None, font_size_var.get()))

root = tk.Tk()
root.title("Font Settings")

# Font families
font_families = ["Helvetica", "Arial", "Times New Roman", "Courier New"]
font_family_var = tk.StringVar(root)
font_family_var.set(font_families[0])  # Set default font family

font_family_label = tk.Label(root, text="Font Family:")
font_family_label.grid(row=0, column=0, padx=5, pady=5)

font_family_combobox = ttk.Combobox(root, textvariable=font_family_var, values=font_families)
font_family_combobox.grid(row=0, column=1, padx=5, pady=5)
font_family_combobox.bind("<<ComboboxSelected>>", apply_font_face)

# Font sizes
font_size_var = tk.IntVar(root)
font_size_var.set(12)  # Set default font size

font_size_label = tk.Label(root, text="Font Size:")
font_size_label.grid(row=1, column=0, padx=5, pady=5)

font_size_combobox = ttk.Combobox(root, textvariable=font_size_var, values=list(range(8, 73)))
font_size_combobox.grid(row=1, column=1, padx=5, pady=5)
font_size_combobox.bind("<<ComboboxSelected>>", apply_font_size)

# Text widget
text_widget = tk.Text(root, wrap="word", font=("Helvetica", 12))
text_widget.grid(row=2, column=0, columnspan=2, padx=5, pady=5)

root.mainloop()


# Font and Size tags overwrite each other.
