"""
Now that I have a function that converts text files created in a tkinter 
interface into clean .Docx files, I need to incorporate font faces and 
font sizes into the interface without interfering with the conversion function. 
"""


import tkinter as tk
from tkinter import font
from tkinter import messagebox
import uuid

def apply_font():
    if text_widget.tag_ranges("sel"):
        selected_font = font_family_var.get()
        if selected_font:
            tag_name = "font_" + str(uuid.uuid4())
            text_widget.tag_add(tag_name, "sel.first", "sel.last")
            text_widget.tag_configure(tag_name, font=(selected_font, font_size_var.get()))
            apply_formatting()
        else:
            messagebox.showwarning("Warning", "Please select a font face.")
    else:
        messagebox.showwarning("Warning", "No text selected.")

def apply_font_size():
    if text_widget.tag_ranges("sel"):
        tag_name = "font_" + str(uuid.uuid4())
        text_widget.tag_add(tag_name, "sel.first", "sel.last")
        text_widget.tag_configure(tag_name, font=(font_family_var.get(), font_size_var.get()))
        apply_formatting()
    else:
        messagebox.showwarning("Warning", "No text selected.")

def apply_bold():
    if bold_var.get():
        text_widget.tag_add("bold", "sel.first", "sel.last")
    else:
        text_widget.tag_remove("bold", "sel.first", "sel.last")

def apply_italic():
    if italic_var.get():
        text_widget.tag_add("italic", "sel.first", "sel.last")
    else:
        text_widget.tag_remove("italic", "sel.first", "sel.last")

def apply_overstrike():
    if overstrike_var.get():
        text_widget.tag_add("overstrike", "sel.first", "sel.last")
    else:
        text_widget.tag_remove("overstrike", "sel.first", "sel.last")

def apply_underline():
    if underline_var.get():
        text_widget.tag_add("underline", "sel.first", "sel.last")
    else:
        text_widget.tag_remove("underline", "sel.first", "sel.last")

root = tk.Tk()
root.title("Font Settings")

font_families = ["Helvetica", "Arial", "Times New Roman", "Courier New"]
font_family_var = tk.StringVar(root)
font_family_var.set(font_families[0])

font_family_label = tk.Label(root, text="Font Family:")
font_family_label.grid(row=0, column=0, padx=5, pady=5)

font_family_menu = tk.OptionMenu(root, font_family_var, *font_families)
font_family_menu.grid(row=0, column=1, padx=5, pady=5)

apply_font_button = tk.Button(root, text="Apply Font", command=apply_font)
apply_font_button.grid(row=0, column=2, padx=5, pady=5)

font_size_var = tk.IntVar(root)
font_size_var.set(12)

font_size_label = tk.Label(root, text="Font Size:")
font_size_label.grid(row=1, column=0, padx=5, pady=5)

font_size_spinbox = tk.Spinbox(root, from_=8, to=72, textvariable=font_size_var)
font_size_spinbox.grid(row=1, column=1, padx=5, pady=5)

apply_font_size_button = tk.Button(root, text="Apply Font Size", command=apply_font_size)
apply_font_size_button.grid(row=1, column=2, padx=5, pady=5)

bold_var = tk.BooleanVar()
bold_checkbox = tk.Checkbutton(root, text="Bold", variable=bold_var, command=apply_bold)
bold_checkbox.grid(row=0, column=3, padx=5, pady=5)

italic_var = tk.BooleanVar()
italic_checkbox = tk.Checkbutton(root, text="Italic", variable=italic_var, command=apply_italic)
italic_checkbox.grid(row=0, column=4, padx=5, pady=5)

overstrike_var = tk.BooleanVar()
overstrike_checkbox = tk.Checkbutton(root, text="Overstrike", variable=overstrike_var, command=apply_overstrike)
overstrike_checkbox.grid(row=1, column=3, padx=5, pady=5)

underline_var = tk.BooleanVar()
underline_checkbox = tk.Checkbutton(root, text="Underline", variable=underline_var, command=apply_underline)
underline_checkbox.grid(row=1, column=4, padx=5, pady=5)

text_widget = tk.Text(root, wrap="word", font=("Helvetica", 12))
text_widget.grid(row=2, column=0, columnspan=5, padx=5, pady=5)

root.mainloop()

