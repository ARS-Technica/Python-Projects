"""
Now that I have a function that converts text files created in a tkinter 
interface into clean .Docx files, I need to incorporate font faces and 
font sizes into the interface without interfering with the conversion function. 
"""


import tkinter as tk
from tkinter import font
from tkinter import messagebox
from tkinter import ttk
import uuid

def apply_font(event=None):
    if text_widget.tag_ranges("sel"):
        selected_font = font_family_var.get()
        if selected_font:
            # Remove existing font size tag, if any
            for tag in text_widget.tag_names("sel.first"):
                if tag.startswith("font_size_"):
                    text_widget.tag_remove(tag, "sel.first", "sel.last")
            # Apply the font configuration to the selected text
            text_widget.tag_add(selected_font, "sel.first", "sel.last")
        else:
            messagebox.showwarning("Warning", "Please select a font face.")
    else:
        messagebox.showwarning("Warning", "No text selected.")

def apply_font_size(event=None):
    if text_widget.tag_ranges("sel"):
        selected_font_size = font_size_var.get()
        # Generate a unique tag for the selected text
        tag_name = f"font_size_{selected_font_size}"
        text_widget.tag_add(tag_name, "sel.first", "sel.last")
        # Apply the font size configuration to the selected text
        text_widget.tag_configure(tag_name, font=(font_family_var.get(), selected_font_size))
    else:
        messagebox.showwarning("Warning", "No text selected.")

root = tk.Tk()
root.title("Font Settings")

# Font families
font_families = ["Helvetica", "Arial", "Times New Roman", "Courier New"]
font_family_var = tk.StringVar(root)
font_family_var.set(font_families[0])  # Set default font family

font_family_label = tk.Label(root, text="Font Family:")
font_family_label.grid(row=0, column=0, padx=5, pady=5)

font_family_combobox = ttk.Combobox(root, textvariable=font_family_var, values=font_families)
font_family_combobox.grid(row=0, column=1, padx=5, pady=5)
font_family_combobox.bind("<<ComboboxSelected>>", apply_font)

# Font sizes
font_size_var = tk.IntVar(root)
font_size_var.set(12)  # Set default font size

font_size_label = tk.Label(root, text="Font Size:")
font_size_label.grid(row=1, column=0, padx=5, pady=5)

font_size_combobox = ttk.Combobox(root, textvariable=font_size_var, values=list(range(8, 73)))
font_size_combobox.grid(row=1, column=1, padx=5, pady=5)
font_size_combobox.bind("<<ComboboxSelected>>", apply_font_size)

# Text widget
text_widget = tk.Text(root, wrap="word", font=("Helvetica", 12))
text_widget.grid(row=2, column=0, columnspan=2, padx=5, pady=5)

root.mainloop()


# Highlighted text does not remain highlighted
