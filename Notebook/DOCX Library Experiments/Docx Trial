"""
After considerable difficulty writting an .rtf file editor in Python 3.x,
this program is an attempt to use the .docx file format in place of .rtf.

Using Python's Tkinter and docx libraries, I've created a simple text widget
with a button to make selected text bold and an export button that saves the
text on the text widget as a .docx file that preserves the bold formatting
applied to the text.
"""

"""
The last draft made all of the text in a paragraph with a bold tag
appear bold after the file was saved as a .docx file.  This version
doesn't show any bold formatting.
"""

import tkinter as tk
from tkinter import scrolledtext
from docx import Document

def make_bold(text_widget):
    current_tags = text_widget.tag_names("sel.first")
    if "bold" in current_tags:
        text_widget.tag_remove("bold", "sel.first", "sel.last")
    else:
        text_widget.tag_add("bold", "sel.first", "sel.last")
        text_widget.tag_configure("bold", font=("Helvetica", 12, "bold"))

def export_to_docx(text_widget):
    content = text_widget.get("1.0", tk.END)
    doc = Document()
    paragraphs = content.split('\n')
    for paragraph in paragraphs:
        p = doc.add_paragraph()
        for index, word in enumerate(paragraph.split()):
            run = p.add_run(word)
            if "bold" in text_widget.tag_names(f"1.{len(paragraph[:sum(len(x)+1 for x in paragraphs[:index])])}"):
                run.bold = True
            if index < len(paragraph.split()) - 1:
                run.add_text(" ")

    doc.save("output.docx")

def main():
    root = tk.Tk()
    root.title("Text Editor")

    text_widget = scrolledtext.ScrolledText(root, wrap=tk.WORD, font=("Helvetica", 12))
    text_widget.pack(expand=True, fill='both')

    bold_button = tk.Button(root, text="Make Bold", command=lambda: make_bold(text_widget))
    bold_button.pack(pady=5)

    export_button = tk.Button(root, text="Export to .docx", command=lambda: export_to_docx(text_widget))
    export_button.pack(pady=5)

    root.mainloop()

if __name__ == "__main__":
    main()


